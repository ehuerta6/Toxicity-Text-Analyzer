<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Conexión Backend</title>
  </head>
  <body>
    <h1>Test de Conexión al Backend</h1>

    <button onclick="testHealth()">Test Health Endpoint</button>
    <button onclick="testAnalyze()">Test Analyze Endpoint</button>

    <div id="results"></div>

    <script>
      const API_BASE = 'http://127.0.0.1:8000';

      async function testHealth() {
        try {
          console.log('Probando endpoint /health...');
          const response = await fetch(`${API_BASE}/health`);
          console.log('Respuesta health:', response);

          if (response.ok) {
            const data = await response.json();
            document.getElementById('results').innerHTML = `
                        <h3>✅ Health OK</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
          } else {
            document.getElementById('results').innerHTML = `
                        <h3>❌ Health Error</h3>
                        <p>Status: ${response.status}</p>
                    `;
          }
        } catch (error) {
          console.error('Error en health:', error);
          document.getElementById('results').innerHTML = `
                    <h3>❌ Error de Conexión</h3>
                    <p>${error.message}</p>
                `;
        }
      }

      async function testAnalyze() {
        try {
          console.log('Probando endpoint /analyze...');
          const response = await fetch(`${API_BASE}/analyze`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ text: 'test message' }),
          });
          console.log('Respuesta analyze:', response);

          if (response.ok) {
            const data = await response.json();
            document.getElementById('results').innerHTML = `
                        <h3>✅ Analyze OK</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
          } else {
            const errorData = await response.json().catch(() => ({}));
            document.getElementById('results').innerHTML = `
                        <h3>❌ Analyze Error</h3>
                        <p>Status: ${response.status}</p>
                        <pre>${JSON.stringify(errorData, null, 2)}</pre>
                    `;
          }
        } catch (error) {
          console.error('Error en analyze:', error);
          document.getElementById('results').innerHTML = `
                    <h3>❌ Error de Conexión</h3>
                    <p>${error.message}</p>
                `;
        }
      }
    </script>
  </body>
</html>
